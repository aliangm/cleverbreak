<!--
  Generated template for the MessageviewPage page.

  See http://ionicframework.com/docs/components/#navigation for more info on
  Ionic pages and navigation.
-->
<ion-header>
  <ion-navbar>
    <ion-buttons left>
      <button ion-button icon-only (click)="dismiss()">
        <ion-icon name="arrow-back"></ion-icon>
      </button>
    </ion-buttons>
    <ion-title>
      <img class="avatar-icon" src="{{appInfo.common.url}}images/users/{{conversation.targetUser.picture}}" />
      <span class="title-name">{{conversation.targetUser.firstname}} {{conversation.targetUser.lastname}}</span>
    </ion-title>
    <ion-buttons end>
      <button (click)="callToUser()" class="call-btn">
        <ion-icon ios="ios-call" md="md-call"></ion-icon>
      </button>
    </ion-buttons>
  </ion-navbar>
</ion-header>

<ion-content padding>
  <ion-list>
    <ion-item *ngFor="let message of messageList" [ngClass]="{'myMsgItem': message.user_from != conversation.targetUser.id}">
      <div class="msg-item-wrapper">
        <ion-row>
          <ion-col class="avatar-icon" text-right>
            <img src="{{appInfo.common.url}}images/users/{{conversation.targetUser.picture}}" />
          </ion-col>
          <ion-col class="msg-text">
            <div class="msg-text-inner" text-wrap>
              <div class="triangle"></div>
              <span *ngIf="message.status == 3">
                <ion-icon ios="ios-call" md="md-call" color="secondary"></ion-icon>
              </span>
              <span *ngIf="message.status == 4">
                <ion-icon ios="ios-call" md="md-call" color="danger"></ion-icon>
              </span>
              {{message.msg}}
            </div>
            <div class="msg-time">
              {{message.created | amParse:'YYYY-MM-DD HH:mm:ss' | amDateFormat: 'DD HH:mm'}}
            </div>
          </ion-col>
        </ion-row>
      </div>
    </ion-item>
  </ion-list>
</ion-content>

<ion-footer>
  <ion-row>
    <ion-col col-11>
      <ion-input type="text" placeholder="Input message" [(ngModel)]="inputText"></ion-input>
    </ion-col>
    <ion-col class="send-btn-col" col-1>
      <button ion-button clear class="send-btn-col-inner" (click)="sendMsg()">
        <ion-icon ios="ios-send" md="ios-send"></ion-icon>
      </button>
    </ion-col>
  </ion-row>
</ion-footer>